[workspace]
resolver = "2"

members = [
  "crates/storage",
  "crates/proto",
  "crates/network",
  "firmware/esp32c3",
  "utils/image_sender",
]

default-members = [
  "crates/storage",
  "crates/proto",
  "crates/network",
  "utils/image_sender",
]

exclude = ["old"]

[workspace.dependencies]
# Workspace crates
cyberpixie-storage = { path = "crates/storage" }
cyberpixie-proto = { path = "crates/proto" }
cyberpixie-std-network = { path = "crates/network" }

# Common dependencies
embedded-hal = "1.0.0-alpha.9"
embedded-svc = "0.24"
embuild = "0.31"
esp-idf-hal = "0.40"
esp-idf-svc = "0.45"
esp-idf-sys = { version = "0.32", features = ["binstart"] }
heapless = { version = "0.7" }
nb-utils = { git = "https://github.com/alekseysidorov/nb-utils.git", branch = "main" }
postcard = { version = "1.0", features = ["experimental-derive"] }
postcard-derive = "0.1.0"

# Profile section
[profile.release]
opt-level = "s"
lto = true

[profile.dev]
debug = true # Symbols are nice and they don't increase the size on Flash
opt-level = "z"
lto = true
